<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>湖癔科技 - 社交群管理通知生成系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "SimSun", sans-serif;
        }
        body {
            background-color: #f5f5f5;
            padding: 1rem;
            font-size: 14px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .header {
            text-align: center;
            padding: 0.8rem 0;
            border-bottom: 2px solid #4299e1;
        }
        .header h1 {
            color: #222;
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }
        .header p {
            color: #666;
            font-size: 0.9rem;
        }
        .content {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        @media (min-width: 992px) {
            .content {
                flex-direction: row;
            }
            .form-panel {
                width: 33%;
            }
            .result-panel {
                width: 67%;
            }
        }
        .panel {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 1.2rem;
            box-shadow: 0 1px 5px rgba(0,0,0,0.06);
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.4rem;
            color: #333;
            font-weight: 600;
            font-size: 0.95rem;
        }
        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.95rem;
            color: #333;
            outline: none;
        }
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        .form-group select:focus,
        .form-group input:focus,
        .form-group textarea:focus {
            border-color: #4299e1;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.15);
        }
        .btn {
            width: 100%;
            padding: 0.9rem;
            background-color: #4299e1;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #3182ce;
        }
        .btn-clear {
            background-color: #718096;
            margin-top: 0.8rem;
        }
        .btn-clear:hover {
            background-color: #4a5568;
        }
        .result-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px solid #f0f0f0;
        }
        .result-header h2 {
            color: #222;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .result-actions {
            display: flex;
            gap: 0.8rem;
        }
        .action-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #fff;
            color: #333;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .action-btn:hover {
            background-color: #f5f5f5;
            border-color: #4299e1;
            color: #4299e1;
        }
        .notice-content {
            line-height: 2.1;
            color: #333;
            font-size: 1.05rem;
            white-space: pre-line;
            padding: 1.5rem;
            border: 1px dashed #e0e0e0;
            background-color: #fdfdfd;
            border-radius: 4px;
            font-family: "SimSun", serif;
            max-height: 600px;
            overflow-y: auto;
        }
        .footer {
            text-align: center;
            color: #666;
            font-size: 0.85rem;
            margin-top: 1.5rem;
            padding: 1rem 0;
            border-top: 1px solid #e0e0e0;
        }
        .scene-tip {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.3rem;
            font-style: italic;
        }
        .divider {
            height: 1px;
            background-color: #f0f0f0;
            margin: 1rem 0;
        }
        .storage-tip {
            text-align: center;
            color: #666;
            font-size: 0.85rem;
            margin: 0.5rem 0;
            color: #4299e1;
        }
        .field-desc {
            font-size: 0.8rem;
            color: #888;
            margin-top: 0.2rem;
        }
        .tag-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .tag {
            padding: 0.3rem 0.6rem;
            background-color: #f5f5f5;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            border: 1px solid transparent;
            pointer-events: auto;
            user-select: none;
            transition: all 0.2s;
        }
        .tag:hover {
            border-color: #4299e1;
            background-color: #e8f4f8;
        }
        .tag.active {
            background-color: #2b6cb0;
            color: #fff;
            border-color: #2b6cb0;
            font-weight: 500;
        }
        /* 手机端适配优化 */
        @media (max-width: 767px) {
            .result-header {
                flex-direction: column;
                align-items: flex-start;
            }
            .result-actions {
                width: 100%;
                justify-content: space-between;
                gap: 0.5rem;
            }
            .action-btn {
                flex: 1;
                text-align: center;
                padding: 0.5rem 0.3rem;
                font-size: 0.85rem;
            }
            .notice-content {
                max-height: 400px;
            }
            .tag {
                padding: 0.25rem 0.5rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>湖癔科技 - 社交群管理通知生成系统</h1>
            <p>覆盖QQ/微信群规、群公告、群内纠纷处理等12+场景，适配手机/平板/电脑</p>
        </div>
        <div class="content">
            <!-- 表单面板 -->
            <div class="form-panel">
                <div class="panel">
                    <form id="groupForm">
                        <div class="form-group">
                            <label for="groupScene">群管理场景</label>
                            <select id="groupScene" required>
                                <option value="">请选择核心场景</option>
                                <!-- 群规相关 -->
                                <option value="groupRuleNew">新建群规通知</option>
                                <option value="groupRuleUpdate">群规更新通知</option>
                                <option value="groupRuleRemind">群规重申提醒</option>
                                <!-- 群公告相关 -->
                                <option value="groupAnnounceEvent">活动通知公告</option>
                                <option value="groupAnnounceDaily">日常事项公告</option>
                                <option value="groupAnnounceImportant">重要事项公告</option>
                                <option value="groupAnnounceDismiss">群解散通知</option>
                                <!-- 群内纠纷处理 -->
                                <option value="groupDisputeWarning">群内纠纷警告通知</option>
                                <option value="groupDisputeSettle">群内纠纷调解结果通知</option>
                                <option value="groupMemberKick">成员移出群聊通知</option>
                                <option value="groupMemberMute">成员禁言通知</option>
                                <!-- 其他管理场景 -->
                                <option value="groupRecruit">群成员招募公告</option>
                                <option value="groupAdminChange">群管理员变更通知</option>
                                <option value="otherGroupManage">其他群管理通知</option>
                            </select>
                            <div class="scene-tip">选择后将自动适配对应字段，违规类型可多选</div>
                        </div>
                        <!-- 基础信息字段（所有场景通用） -->
                        <div class="divider"></div>
                        <h3 style="color:#4299e1; margin-bottom:1rem; font-size:1.1rem;">基础信息（必填）</h3>
                        <div class="form-group">
                            <label for="groupTitle">通知标题（自动生成，可修改）</label>
                            <input type="text" id="groupTitle" placeholder="系统将根据场景自动生成，可自定义调整">
                        </div>
                        <div class="form-group">
                            <label for="groupInfo">群聊基本信息</label>
                            <input type="text" id="groupInfo" placeholder="例如：QQ群-湖癔科技交流群（群号：88888888，群主：张三）；微信群-湖癔OS测试群（群主微信：zhangsan123）" required value="QQ群-湖癔科技交流群（群号：88888888，群主：张三）">
                            <div class="field-desc">需填写群类型、群名、群号/标识、群主信息</div>
                        </div>
                        <div class="form-group">
                            <label for="groupRecipient">通知对象</label>
                            <input type="text" id="groupRecipient" placeholder="例如：全体群成员、相关违规成员、新入群成员" required value="全体群成员">
                        </div>
                        <div class="form-group">
                            <label for="groupDate">通知发布日期</label>
                            <input type="text" id="groupDate" placeholder="例如：2026年01月01日" required value="2026年01月01日">
                        </div>
                        <div class="form-group">
                            <label for="contactPerson">联系人及联系方式</label>
                            <input type="text" id="contactPerson" placeholder="例如：群主张三，QQ：88888888，电话：13800138000" required value="群主/管理员，联系方式：13800138000">
                        </div>
                        <!-- 场景化核心字段（动态适配） -->
                        <div class="divider"></div>
                        <h3 style="color:#4299e1; margin-bottom:1rem; font-size:1.1rem;">场景核心信息</h3>
                        
                        <!-- 群规相关字段 -->
                        <div id="ruleFields" style="display:none;">
                            <div class="form-group">
                                <label>群规核心条款（可多选，点击选中）</label>
                                <div class="tag-group" id="ruleClauseTags">
                                    <div class="tag" data-value="禁止吵架辱骂">禁止吵架辱骂</div>
                                    <div class="tag" data-value="禁止色情低俗">禁止色情低俗</div>
                                    <div class="tag" data-value="禁止广告骚扰">禁止广告骚扰</div>
                                    <div class="tag" data-value="禁止造谣诽谤">禁止造谣诽谤</div>
                                    <div class="tag" data-value="禁止侵犯隐私">禁止侵犯隐私</div>
                                    <div class="tag" data-value="禁止恶意刷屏">禁止恶意刷屏</div>
                                    <div class="tag" data-value="禁止无关话题">禁止无关话题</div>
                                    <div class="tag" data-value="实名/备注要求">实名/备注要求</div>
                                    <div class="tag" data-value="违规处理规则">违规处理规则</div>
                                    <div class="tag" data-value="其他条款">其他条款</div>
                                </div>
                                <input type="hidden" id="ruleClauses" value="禁止吵架辱骂、禁止广告骚扰、违规处理规则">
                            </div>
                            <div class="form-group">
                                <label for="ruleDetail">群规具体内容</label>
                                <textarea id="ruleDetail" placeholder="例如：1. 禁止在群内发布色情、暴力、辱骂等违规内容，违者首次警告，二次禁言7天，三次移出群聊；2. 广告发布需提前联系管理员，未经允许擅自发布者直接移出..." required>1. 文明交流，禁止发布色情、暴力、辱骂、广告等违规内容，违者首次警告，二次禁言7天，三次永久移出群聊；
2. 群成员需按要求修改备注（格式：姓名-单位），3日内未修改者移出；
3. 禁止恶意刷屏、发布无关话题，管理员有权删除违规内容；
4. 尊重他人隐私，禁止泄露群成员个人信息。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="ruleEffectiveTime">群规生效时间</label>
                                <input type="text" id="ruleEffectiveTime" placeholder="例如：2026年01月01日 00:00起" required value="本通知发布之日起">
                            </div>
                            <div class="form-group">
                                <label for="ruleRemark">补充说明</label>
                                <textarea id="ruleRemark" placeholder="例如：请现有成员在3日内完成备注修改；群规解释权归管理员团队所有">群规解释权归湖癔科技群管理团队所有，如有疑问可联系群主咨询。</textarea>
                            </div>
                        </div>
                        <!-- 群公告相关字段 -->
                        <div id="announceFields" style="display:none;">
                            <div class="form-group">
                                <label for="announceTheme">公告核心主题</label>
                                <input type="text" id="announceTheme" placeholder="例如：2026年湖癔OS线下体验会、群内禁言维护通知、群解散原因说明" required value="群内重要事项通知">
                            </div>
                            <div class="form-group">
                                <label for="announceDetail">公告具体内容</label>
                                <textarea id="announceDetail" placeholder="例如：活动通知需说明时间、地点、报名方式；日常事项需说明具体要求；解散通知需说明原因及后续安排" required>为提升群聊质量，现通知如下：1. 本群将于2026年01月10日举办线下体验会；2. 地点：XX市XX区XX科技园区；3. 报名方式：联系群主提交姓名+联系方式。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="announceTime">相关时间节点</label>
                                <input type="text" id="announceTime" placeholder="例如：活动时间：2026年01月10日 14:00；报名截止时间：2026年01月05日" required value="活动时间：2026年01月10日 14:00；报名截止时间：2026年01月05日">
                                <div class="field-desc">无时间要求可填写"长期有效"或"即时生效"</div>
                            </div>
                            <div class="form-group">
                                <label for="announceRequirement">相关要求/注意事项</label>
                                <textarea id="announceRequirement" placeholder="例如：活动需提前报名确认；禁言期间禁止私聊骚扰管理员；解散后相关资料将保留7天" required>1. 参与活动需提前报名，未报名者不予入场；2. 活动期间遵守现场秩序，听从工作人员安排；3. 如有特殊情况无法参与，请提前告知群主。</textarea>
                            </div>
                        </div>
                        <!-- 群内纠纷处理字段 -->
                        <div id="disputeFields" style="display:none;">
                            <div class="form-group">
                                <label for="disputeParties">纠纷相关方信息</label>
                                <input type="text" id="disputeParties" placeholder="例如：违规成员：李四（QQ号：99999999）；投诉成员：王五（QQ号：77777777）" required value="违规成员：李四（QQ号：99999999）；投诉成员：王五（QQ号：77777777）">
                            </div>
                            <div class="form-group">
                                <label>纠纷类型（可多选，点击选中）</label>
                                <div class="tag-group" id="disputeTypeTags">
                                    <div class="tag" data-value="吵架辱骂">吵架辱骂</div>
                                    <div class="tag" data-value="恶意刷屏">恶意刷屏</div>
                                    <div class="tag" data-value="广告骚扰">广告骚扰</div>
                                    <div class="tag" data-value="造谣诽谤">造谣诽谤</div>
                                    <div class="tag" data-value="人身攻击">人身攻击</div>
                                    <div class="tag" data-value="其他纠纷">其他纠纷</div>
                                </div>
                                <input type="hidden" id="disputeType" value="吵架辱骂、广告骚扰">
                            </div>
                            <div class="form-group">
                                <label for="disputeProcess">纠纷发生经过</label>
                                <textarea id="disputeProcess" placeholder="例如：2026年01月01日 10:00，成员李四在群内发布广告并辱骂劝阻的王五，具体言论为：XXX... 管理员已截图取证" required>2026年01月01日 10:00，成员李四在群内发布无关广告，成员王五劝阻后，李四对王五进行辱骂，具体言论为："XXX"，管理员已截图取证。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="disputeHandle">处理结果/措施</label>
                                <textarea id="disputeHandle" placeholder="例如：1. 对李四进行警告，要求公开道歉；2. 禁言7天；3. 若再次违规直接移出群聊；4. 已将相关证据留存" required>1. 对违规成员李四进行严重警告，要求其在群内公开道歉；2. 给予禁言7天的处罚；3. 若再次违规，直接永久移出群聊；4. 相关证据已留存，供后续追溯。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="disputeRemind">后续提醒</label>
                                <textarea id="disputeRemind" placeholder="例如：请全体成员遵守群规，文明交流；遇到纠纷及时联系管理员，禁止私下报复" required>请全体成员遵守群规，文明交流，遇到问题及时联系管理员沟通解决，禁止私下争执或报复行为，共同维护群聊秩序。</textarea>
                            </div>
                        </div>
                        <!-- 其他管理场景字段 -->
                        <div id="otherFields" style="display:none;">
                            <div class="form-group">
                                <label for="otherTheme">管理事项主题</label>
                                <input type="text" id="otherTheme" placeholder="例如：湖癔科技交流群招募新成员、管理员变更说明、群内资料整理通知" required value="群管理员变更通知">
                            </div>
                            <div class="form-group">
                                <label for="otherDetail">管理事项具体内容</label>
                                <textarea id="otherDetail" placeholder="例如：招募需说明入群条件、申请方式；管理员变更需说明新管理员信息、职责；资料整理需说明整理范围、时间" required>现通知：原管理员张三因个人原因不再担任本群管理员，新任管理员为赵六（QQ号：66666666），自2026年01月05日起生效；新管理员负责日常群管理、违规处理、活动组织等工作。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="otherRequirement">相关要求</label>
                                <textarea id="otherRequirement" placeholder="例如：入群需备注姓名+单位；新管理员将负责日常管理；资料整理期间禁止上传新文件" required>1. 请全体成员配合新任管理员工作；2. 新管理员需严格按照群规执行管理职责；3. 如有对管理员工作的建议或异议，可私信群主反馈。</textarea>
                            </div>
                            <div class="form-group">
                                <label for="otherTime">时间要求</label>
                                <input type="text" id="otherTime" placeholder="例如：招募截止时间：2026年01月10日；管理员生效时间：2026年01月05日" required value="管理员生效时间：2026年01月05日">
                            </div>
                        </div>
                        <!-- 补充条款 -->
                        <div class="divider"></div>
                        <h3 style="color:#4299e1; margin-bottom:1rem; font-size:1.1rem;">补充信息</h3>
                        <div class="form-group">
                            <label for="additionalClause">补充条款（可选）</label>
                            <textarea id="additionalClause">1. 本通知最终解释权归湖癔科技群管理团队所有；2. 请全体成员严格遵守相关要求，共同维护群聊秩序；3. 如有疑问可联系群主/管理员咨询，禁止恶意骚扰；4. 本通知自发布之日起生效。</textarea>
                        </div>
                        <button type="submit" class="btn">生成群管理通知</button>
                        <button type="button" class="btn btn-clear" id="clearStorageBtn">一键清空本地存储</button>
                        <div class="storage-tip">已自动保存表单数据，刷新页面不丢失</div>
                    </form>
                </div>
            </div>
            <!-- 结果面板 -->
            <div class="result-panel">
                <div class="panel">
                    <div class="result-header">
                        <h2>湖癔科技社交群管理通知（可直接使用）</h2>
                        <div class="result-actions">
                            <button class="action-btn" id="copyBtn">复制全文</button>
                            <button class="action-btn" id="downloadBtn">导出为TXT</button>
                        </div>
                    </div>
                    <div class="notice-content" id="groupContent">
                        请选择群管理场景并填写完整信息，点击"生成群管理通知"按钮获取完整内容...
                        提示：本系统生成的通知符合社交群管理规范，可直接复制到QQ/微信群内发布或私信通知相关成员。
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            湖癔科技 © 2026 | 本群管理通知模板基于社交平台管理规则及公序良俗制定，用于规范群聊秩序，重大纠纷建议通过平台官方渠道处理
        </div>
    </div>
    <script>
        // 全局DOM对象管理
        const dom = {
            groupScene: document.getElementById('groupScene'),
            groupTitle: document.getElementById('groupTitle'),
            groupForm: document.getElementById('groupForm'),
            groupContent: document.getElementById('groupContent'),
            copyBtn: document.getElementById('copyBtn'),
            downloadBtn: document.getElementById('downloadBtn'),
            clearStorageBtn: document.getElementById('clearStorageBtn'),
            // 场景字段容器
            ruleFields: document.getElementById('ruleFields'),
            announceFields: document.getElementById('announceFields'),
            disputeFields: document.getElementById('disputeFields'),
            otherFields: document.getElementById('otherFields'),
            // 标签容器及隐藏输入框
            ruleClauseTags: document.getElementById('ruleClauseTags'),
            disputeTypeTags: document.getElementById('disputeTypeTags'),
            ruleClauses: document.getElementById('ruleClauses'),
            disputeType: document.getElementById('disputeType'),
            // 其他字段
            groupInfo: document.getElementById('groupInfo'),
            groupRecipient: document.getElementById('groupRecipient'),
            groupDate: document.getElementById('groupDate'),
            contactPerson: document.getElementById('contactPerson'),
            ruleDetail: document.getElementById('ruleDetail'),
            ruleEffectiveTime: document.getElementById('ruleEffectiveTime'),
            ruleRemark: document.getElementById('ruleRemark'),
            announceTheme: document.getElementById('announceTheme'),
            announceDetail: document.getElementById('announceDetail'),
            announceTime: document.getElementById('announceTime'),
            announceRequirement: document.getElementById('announceRequirement'),
            disputeParties: document.getElementById('disputeParties'),
            disputeProcess: document.getElementById('disputeProcess'),
            disputeHandle: document.getElementById('disputeHandle'),
            disputeRemind: document.getElementById('disputeRemind'),
            otherTheme: document.getElementById('otherTheme'),
            otherDetail: document.getElementById('otherDetail'),
            otherRequirement: document.getElementById('otherRequirement'),
            otherTime: document.getElementById('otherTime'),
            additionalClause: document.getElementById('additionalClause')
        };

        // 核心标签初始化函数（确保实时同步）
        function initTags(tagContainer, hiddenInput) {
            if (!tagContainer || !hiddenInput) return;
            
            // 重置所有标签状态
            const tags = Array.from(tagContainer.querySelectorAll('.tag'));
            tags.forEach(tag => {
                tag.classList.remove('active');
            });
            
            // 初始化默认选中标签
            const defaultVals = hiddenInput.value.split('、');
            tags.forEach(tag => {
                if (defaultVals.includes(tag.dataset.value)) {
                    tag.classList.add('active');
                }
            });
            
            // 绑定点击事件（无事件阻止，确保100%响应）
            tags.forEach(tag => {
                tag.onclick = function() {
                    this.classList.toggle('active');
                    // 实时收集选中值
                    const selectedTags = tags.filter(t => t.classList.contains('active')).map(t => t.dataset.value);
                    // 处理无选中标签的情况
                    hiddenInput.value = selectedTags.length > 0 ? selectedTags.join('、') : (tagContainer.id === 'ruleClauseTags' ? '其他条款' : '其他纠纷');
                };
            });
        }

        // 场景切换逻辑（标签状态独立，无干扰）
        dom.groupScene.addEventListener('change', function() {
            // 隐藏所有字段
            dom.ruleFields.style.display = 'none';
            dom.announceFields.style.display = 'none';
            dom.disputeFields.style.display = 'none';
            dom.otherFields.style.display = 'none';
            
            // 重置所有标签选中状态（关键修复：避免场景间干扰）
            [dom.ruleClauseTags, dom.disputeTypeTags].forEach(container => {
                if (container) {
                    const tags = container.querySelectorAll('.tag');
                    tags.forEach(tag => tag.classList.remove('active'));
                }
            });
            
            // 显示对应字段并初始化标签
            switch(this.value) {
                case 'groupRuleNew':
                case 'groupRuleUpdate':
                case 'groupRuleRemind':
                    dom.ruleFields.style.display = 'block';
                    initTags(dom.ruleClauseTags, dom.ruleClauses);
                    break;
                case 'groupAnnounceEvent':
                case 'groupAnnounceDaily':
                case 'groupAnnounceImportant':
                case 'groupAnnounceDismiss':
                    dom.announceFields.style.display = 'block';
                    break;
                case 'groupDisputeWarning':
                case 'groupDisputeSettle':
                case 'groupMemberKick':
                case 'groupMemberMute':
                    dom.disputeFields.style.display = 'block';
                    initTags(dom.disputeTypeTags, dom.disputeType);
                    break;
                case 'groupRecruit':
                case 'groupAdminChange':
                case 'otherGroupManage':
                    dom.otherFields.style.display = 'block';
                    break;
            }
            
            // 生成对应标题
            generateTitle(this.value);
        });

        // 生成标题函数
        function generateTitle(scene) {
            const groupName = dom.groupInfo.value.split('（')[0] || '湖癔科技相关群聊';
            const titleMap = {
                'groupRuleNew': `【${groupName}】群规正式发布通知`,
                'groupRuleUpdate': `【${groupName}】群规更新通知`,
                'groupRuleRemind': `【${groupName}】群规重申及文明交流提醒`,
                'groupAnnounceEvent': `【${groupName}】活动通知公告`,
                'groupAnnounceDaily': `【${groupName}】日常事项公告`,
                'groupAnnounceImportant': `【${groupName}】重要事项公告`,
                'groupAnnounceDismiss': `【${groupName}】群解散通知`,
                'groupDisputeWarning': `【${groupName}】群内纠纷警告通知`,
                'groupDisputeSettle': `【${groupName}】群内纠纷调解结果通知`,
                'groupMemberKick': `【${groupName}】成员移出群聊通知`,
                'groupMemberMute': `【${groupName}】成员禁言通知`,
                'groupRecruit': `【${groupName}】成员招募公告`,
                'groupAdminChange': `【${groupName}】管理员变更通知`,
                'otherGroupManage': `【${groupName}】群管理通知`
            };
            dom.groupTitle.value = titleMap[scene] || `【${groupName}】群管理通知`;
        }

        // 生成通知核心逻辑（实时读取标签值，确保同步）
        dom.groupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            try {
                // 基础校验
                if (!dom.groupScene.value) {
                    alert('❌ 请选择群管理场景！');
                    return;
                }
                if (!dom.groupInfo.value.trim()) {
                    alert('❌ 请填写群聊基本信息！');
                    return;
                }
                
                // 实时获取所有数据（重点：标签值直接读取隐藏输入框实时值）
                const data = {
                    title: dom.groupTitle.value,
                    groupInfo: dom.groupInfo.value,
                    recipient: dom.groupRecipient.value,
                    date: dom.groupDate.value,
                    contact: dom.contactPerson.value,
                    additional: dom.additionalClause.value,
                    // 实时标签值（关键修复）
                    ruleClauses: dom.ruleClauses.value,
                    disputeType: dom.disputeType.value,
                    // 其他字段
                    ruleDetail: dom.ruleDetail.value,
                    ruleEffectiveTime: dom.ruleEffectiveTime.value,
                    ruleRemark: dom.ruleRemark.value,
                    announceTheme: dom.announceTheme.value,
                    announceDetail: dom.announceDetail.value,
                    announceTime: dom.announceTime.value,
                    announceRequirement: dom.announceRequirement.value,
                    disputeParties: dom.disputeParties.value,
                    disputeProcess: dom.disputeProcess.value,
                    disputeHandle: dom.disputeHandle.value,
                    disputeRemind: dom.disputeRemind.value,
                    otherTheme: dom.otherTheme.value,
                    otherDetail: dom.otherDetail.value,
                    otherRequirement: dom.otherRequirement.value,
                    otherTime: dom.otherTime.value
                };
                
                let content = '';
                const groupShortName = data.groupInfo.split('（')[0];
                
                // 按场景生成对应内容
                switch(dom.groupScene.value) {
                    // 群规新建
                    case 'groupRuleNew':
                        content = `
${data.title}
致：${data.recipient}
为规范${data.groupInfo}的群聊秩序，营造文明、和谐的交流氛围，经管理员团队研究决定，正式发布本群群规，具体内容如下：
一、群规核心条款
${data.ruleClauses}
二、群规具体内容
${data.ruleDetail}
三、生效时间
本群规自${data.ruleEffectiveTime}正式生效，适用于全体群成员（包括新入群成员）。
四、补充说明
${data.ruleRemark}
${data.additional}
望全体成员自觉遵守群规，文明发言、友善交流，共同维护群聊的良好环境。如有违反群规的行为，管理员将按照相关规定进行处理，感谢大家的理解与配合！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 群规更新
                    case 'groupRuleUpdate':
                        content = `
${data.title}
致：${data.recipient}
为适应群聊发展需要，进一步优化交流环境，${groupShortName}管理团队对原有群规进行了修订更新，现将最新群规通知如下：
一、更新后核心条款
${data.ruleClauses}
二、更新后具体内容
${data.ruleDetail}
三、生效时间
本次群规更新自${data.ruleEffectiveTime}起生效，原有群规同时废止。
四、补充说明
${data.ruleRemark}
${data.additional}
请全体成员认真阅读并遵守更新后的群规，管理员将严格按照新规执行管理职责。如有疑问可联系群主咨询，感谢大家的支持与配合！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 群规重申
                    case 'groupRuleRemind':
                        content = `
${data.title}
致：${data.recipient}
近期发现群内出现部分违反群规的行为，为维护良好的群聊秩序，现重申本群核心群规条款及相关要求：
一、核心群规条款
${data.ruleClauses}
二、重点要求重申
${data.ruleDetail}
三、违规处理说明
凡违反上述群规者，管理员将根据情节轻重采取警告、禁言、移出群聊等措施，望各位成员引以为戒。
${data.ruleRemark}
${data.additional}
文明交流是群聊的基础，感谢全体成员的理解与配合，让我们共同营造和谐的交流环境！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 纠纷调解结果
                    case 'groupDisputeSettle':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}内发生的纠纷事宜，经管理员团队调查核实，现将调解结果及相关情况通知如下：
一、纠纷基本信息
1. 纠纷相关方：${data.disputeParties}
2. 纠纷类型：${data.disputeType}
3. 纠纷发生经过：${data.disputeProcess}
二、调解结果及处理措施
${data.disputeHandle}
三、后续提醒与要求
${data.disputeRemind}
${data.additional}
群聊秩序需要全体成员共同维护，再次提醒大家遵守群规、文明交流，遇到问题及时联系管理员沟通解决，禁止私下争执或报复行为。感谢大家的支持与配合！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 纠纷警告
                    case 'groupDisputeWarning':
                        content = `
${data.title}
致：${data.recipient}
近期群内出现${data.disputeType}类纠纷事件，已影响正常交流秩序，现作出如下警告及要求：
一、纠纷相关情况
1. 涉及方：${data.disputeParties}
2. 事件经过：${data.disputeProcess}
二、警告及处理措施
${data.disputeHandle}
三、后续要求
${data.disputeRemind}
${data.additional}
请全体成员严格遵守群规，相互尊重、文明沟通，杜绝各类纠纷事件再次发生。如有违反，管理员将从严处理！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 成员移出通知
                    case 'groupMemberKick':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}成员移出事宜，通知如下：
一、移出原因
成员${data.disputeParties.split('；')[0].replace('违规成员：', '')}因${data.disputeType}行为，违反群规第${data.disputeProcess.split('。')[0]}条，经管理员团队核实，决定将其移出群聊。
二、处理依据及结果
${data.disputeHandle}
三、警示提醒
${data.disputeRemind}
${data.additional}
群规面前人人平等，望全体成员引以为戒，自觉遵守群规，共同维护群聊秩序。感谢大家的理解与支持！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 成员禁言通知
                    case 'groupMemberMute':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}成员禁言事宜，通知如下：
一、禁言原因
成员${data.disputeParties.split('；')[0].replace('违规成员：', '')}因${data.disputeType}行为，违反群规相关规定，具体经过：${data.disputeProcess}
二、禁言处理结果
${data.disputeHandle}
三、提醒要求
${data.disputeRemind}
${data.additional}
请全体成员遵守群规、文明发言，避免类似违规行为。如有疑问可联系管理员咨询。
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 活动通知公告
                    case 'groupAnnounceEvent':
                        content = `
${data.title}
致：${data.recipient}
为丰富群内交流，${groupShortName}将组织${data.announceTheme}活动，具体安排如下：
一、活动核心信息
${data.announceDetail}
二、关键时间节点
${data.announceTime}
三、参与要求及注意事项
${data.announceRequirement}
${data.additional}
欢迎各位成员积极参与，如有疑问可联系群主咨询。感谢大家的支持！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 日常事项公告
                    case 'groupAnnounceDaily':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}日常管理事项，通知如下：
一、事项主题
${data.announceTheme}
二、具体内容
${data.announceDetail}
三、时间要求
${data.announceTime}
四、相关要求
${data.announceRequirement}
${data.additional}
请全体成员配合执行，共同维护群聊的规范有序。如有疑问可随时联系管理员。
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 重要事项公告
                    case 'groupAnnounceImportant':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}重要事项，紧急通知如下：
一、核心事项
${data.announceTheme}
二、具体说明
${data.announceDetail}
三、时间要求
${data.announceTime}
四、严格要求
${data.announceRequirement}
${data.additional}
本事项事关全体成员利益，请务必认真阅读并遵守相关要求，如有疑问立即联系管理员确认！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 群解散通知
                    case 'groupAnnounceDismiss':
                        content = `
${data.title}
致：${data.recipient}
经${groupShortName}管理团队慎重研究决定，现通知如下：
一、解散原因
${data.announceDetail}
二、时间安排
${data.announceTime}
三、后续事宜
${data.announceRequirement}
${data.additional}
感谢各位成员长期以来的支持与陪伴，祝大家一切顺利！如有需要可通过联系人方式保持沟通。
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 群成员招募
                    case 'groupRecruit':
                        content = `
${data.title}
致：潜在入群成员
为扩大${groupShortName}交流范围，现公开招募新成员，具体要求如下：
一、招募主题
${data.otherTheme}
二、招募详情
${data.otherDetail}
三、报名要求
${data.otherRequirement}
四、时间安排
${data.otherTime}
${data.additional}
欢迎符合条件的朋友积极报名，加入我们的交流大家庭！
特此公告。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 管理员变更
                    case 'groupAdminChange':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}管理员变更事宜，通知如下：
一、变更原因及情况
${data.otherDetail}
二、新管理员职责
${data.otherRequirement}
三、生效时间
${data.otherTime}
${data.additional}
请全体成员配合新任管理员工作，共同维护群聊秩序。如有异议可联系群主反馈。
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                    
                    // 其他群管理通知
                    case 'otherGroupManage':
                        content = `
${data.title}
致：${data.recipient}
现就${data.groupInfo}相关管理事项，通知如下：
一、管理主题
${data.otherTheme}
二、具体内容
${data.otherDetail}
三、时间要求
${data.otherTime}
四、相关要求
${data.otherRequirement}
${data.additional}
请全体成员严格遵守并积极配合，共同保障群聊的规范有序。感谢大家的支持！
特此通知。
${groupShortName} 管理团队
${data.date}
联系人：${data.contact}
`;
                        break;
                }
                
                // 渲染生成的内容
                dom.groupContent.textContent = content.trim();
                alert('✅ 生成成功！右侧内容已同步标签选择结果');
            } catch (err) {
                alert('❌ 生成失败！错误信息：' + err.message);
                console.log('错误详情：', err);
            }
        });

        // 复制功能
        dom.copyBtn.addEventListener('click', function() {
            if (dom.groupContent.textContent.includes('请选择群管理场景')) {
                alert('❌ 请先生成群管理通知再复制！');
                return;
            }
            navigator.clipboard.writeText(dom.groupContent.textContent).then(() => {
                alert('✅ 已复制到剪贴板！');
            }).catch(err => {
                alert('❌ 复制失败，请手动复制：' + err.message);
            });
        });

        // 导出TXT功能
        dom.downloadBtn.addEventListener('click', function() {
            if (dom.groupContent.textContent.includes('请选择群管理场景')) {
                alert('❌ 请先生成群管理通知再导出！');
                return;
            }
            const blob = new Blob([dom.groupContent.textContent], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `湖癔科技群管理通知_${new Date().toLocaleDateString()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
            alert('✅ 导出成功！');
        });

        // 清空本地存储功能
        dom.clearStorageBtn.addEventListener('click', function() {
            if (confirm('⚠️ 确定要清空本地存储吗？清空后表单数据将恢复默认值')) {
                localStorage.removeItem('huyiGroupFormData');
                alert('✅ 本地存储已清空！');
                window.location.reload();
            }
        });

        // 页面加载初始化
        window.addEventListener('load', function() {
            // 默认选中新建群规场景
            if (!dom.groupScene.value) {
                dom.groupScene.value = 'groupRuleNew';
                dom.groupScene.dispatchEvent(new Event('change'));
            } else {
                // 初始化当前场景标签
                if (dom.groupScene.value.includes('rule')) {
                    initTags(dom.ruleClauseTags, dom.ruleClauses);
                } else if (dom.groupScene.value.includes('dispute')) {
                    initTags(dom.disputeTypeTags, dom.disputeType);
                }
            }
        });
    </script>
</body>
</html>
